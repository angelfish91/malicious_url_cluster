import sys
import os
import pandas as pd



def main(file_list):
    root_path = "/home/machangchun/sparrow/data/sangfor/18"
    df_list = []
    for i in file_list:
        local_path = root_path + i
        filepath = os.path.join(local_path ,'dumped_result.ma.csv')
        df_list.append( pd.read_csv(filepath))
        print local_path
        
    df = pd.concat(df_list, axis = 0)
    df = df.loc[df["platform"] == 5003]
    df = df.loc[(df["report_type"] == 1).values + (df["report_type"] == 2).values]
    return df
    
        
if __name__ == "__main__":
    file_list = ["0301","0302","0306","0307","0311","0312","0313","0314","0315","0318","0319",
              "0320","0321","0322","0323","0325","0326","0327","0328","0330","0401","0402"]
    
    df = main(file_list)
    df.to_csv("/home/machangchun/sparrow/data/sangfor/malware.csv")